{% extends 'partials/dashboard-base.html' %}
{% load static %}

{% block content %}
    <link rel="stylesheet" href="{% static 'assets1/css/custom_kyc_fix.css' %}">
    
   
    <!-- header-section end -->

    <!-- Dashboard Section start -->
    <section class="dashboard-section body-collapse account">
        <div class="overlay pt-120">
            <div class="container-fruid">
                <div class="main-content">
                    <div class="row">
                        <div class="col-xxl-3 col-xl-4 col-md-6">
                            <div class="owner-details">
                                <div class="profile-area">
                                    <div class="profile-img">
                                        {% if kyc and kyc.image %}
                                            <img style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover;" src="{{kyc.image.url}}" alt="image">
                                        {% else %}
                                            <img style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover;" src="{% static 'assets1/images/default.jpg' %}" alt="">
                                        {% endif %}
                                    </div>
                                    <div class="name-area">
                                        <h6>{{kyc.full_name|title}}</h6>
                                        {% if account.account_status == "in-active" %}
                                        <p class="active-status text danger">{{account.account_status|title}}</p>
                                        {% endif %}
                                        {% if account.account_status == "active" %}
                                        <p class="active-status ">{{account.account_status|title}}</p>
                                        {% endif %}
                                        {% if account.account_status == "pending" %}
                                        <p class="active-status text warning">{{account.account_status|title}}</p>
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="owner-info">
                                    <ul>
                                        <li>
                                            <p>Account Num:</p>
                                            <span class="mdr">{{account.account_number}}</span>
                                        </li>
                                        <li>
                                            <p>Pin Num:</p>
                                            <span class="mdr" id="pin-display" style="font-family: Arial, sans-serif; letter-spacing: 3px; font-weight: bold;">••••</span>
                                            <button type="button" onclick="togglePin()" style="background: none; border: none; cursor: pointer; color: var(--primary-color); font-size: 14px; margin-left: 8px; vertical-align: middle;">
                                                <i id="pin-icon" class="fas fa-eye"></i>
                                            </button>
                                        </li>
                                        <li>
                                            <p>Joined:</p>
                                            <span class="mdr">{{account.date|date:"d M, Y" }}</span>
                                        </li>
                                        
                                    </ul>
                                </div>
                                <div class="owner-action">
                                    {% if request.user.is_authenticated %}
                                        <a href="{%  url 'userauths:sign-out' %}">
                                            <img src="{% static 'assets1/images/icon/logout.png' %}" alt="image">
                                            Logout
                                        </a>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <div class="col-xxl-9 col-xl-8">
                            <div class="tab-main">
                                <ul class="nav nav-tabs" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="account-tab" data-bs-toggle="tab" data-bs-target="#account" type="button" role="tab" aria-controls="account" aria-selected="true">KYC Registration Form</button>
                                    </li>
                                    
                                </ul>
                                <div class="tab-content mt-40">
                                    <form method="POST" enctype="multipart/form-data">
                                        {% csrf_token %}
                                        <div class="upload-avatar">
                                            {% if form.errors %}
                                            <div class="alert alert-danger">
                                                <strong>Please correct the following errors:</strong>
                                                <ul>
                                                    {% for field, errors in form.errors.items %}
                                                        {% for error in errors %}
                                                            <li>{{ field|title }}: {{ error }}</li>
                                                        {% endfor %}
                                                    {% endfor %}
                                                </ul>
                                            </div>
                                            {% endif %}
                                            <div class="avatar-left d-flex align-items-center">
                                                <div class="profile-img">
                                                    {% if kyc and kyc.image %}
                                                        <img src="{{ kyc.image.url }}" style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover;" alt="image">
                                                    {% else %}
                                                        <img src="{% static 'assets1/images/default.jpg' %}" style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover;" alt="default avatar">
                                                    {% endif %}
                                                </div>
                                                <div class="instraction">
                                                    <h6>Your Avatar</h6>
                                                    <!-- <p>Profile picture size: 400px x 400px</p> -->
                                                </div>
                                            </div>
                                            <div class="avatar-right">
                                                {{form.image}}
                                            </div>
                                        </div>
                                    
                                        <div class="row justify-content-center">
                                            <div class="col-md-6">
                                                <div class="single-input">
                                                    <label for="fName">Full Name</label>
                                                   {{form.full_name}}
                                                   <!-- Replaced inline style with class -->
                                                   {% if form.full_name.errors %}
                                                    <div class="form-error-message">
                                                        {% for error in form.full_name.errors %}
                                                            {{ error }}
                                                        {% endfor %}
                                                    </div>
                                                   {% endif %}
                                                </div>
                                            </div>
                                            
                                            <div class="col-md-6">
                                                <div class="single-input">
                                                    <label for="fName">Mobile Number</label>
                                                   {{form.mobile}}
                                                   {% if form.mobile.errors %}
                                                    <div class="form-error-message">
                                                        {% for error in form.mobile.errors %}
                                                            {{ error }}
                                                        {% endfor %}
                                                    </div>
                                                   {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="single-input">
                                                    <label for="fName">Country</label>
                                                   {{form.country}}
                                                   {% if form.country.errors %}
                                                    <div class="form-error-message">
                                                        {% for error in form.country.errors %}
                                                            {{ error }}
                                                        {% endfor %}
                                                    </div>
                                                   {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="single-input">
                                                    <label for="fName">State</label>
                                                   {{form.state}}
                                                   {% if form.state.errors %}
                                                    <div class="form-error-message">
                                                        {% for error in form.state.errors %}
                                                            {{ error }}
                                                        {% endfor %}
                                                    </div>
                                                   {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="single-input">
                                                    <label for="fName">City</label>
                                                   {{form.city}}
                                                   {% if form.city.errors %}
                                                    <div class="form-error-message">
                                                        {% for error in form.city.errors %}
                                                            {{ error }}
                                                        {% endfor %}
                                                    </div>
                                                   {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="single-input">
                                                    <label for="fName">Mother's Maiden Name</label>
                                                   {{form.mothers_maiden_name}}
                                                   {% if form.mothers_maiden_name.errors %}
                                                    <div class="form-error-message">
                                                        {% for error in form.mothers_maiden_name.errors %}
                                                            {{ error }}
                                                        {% endfor %}
                                                    </div>
                                                   {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-md-12">
                                                <div class="single-input">
                                                    <label for="fName">Date Of Birth</label>
                                                   {{form.date_of_birth}}
                                                   {% if form.date_of_birth.errors %}
                                                    <div class="form-error-message">
                                                        {% for error in form.date_of_birth.errors %}
                                                            {{ error }}
                                                        {% endfor %}
                                                    </div>
                                                   {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="single-input">
                                                    <label for="fName">Gender</label>
                                                   {{form.gender}}
                                                   {% if form.gender.errors %}
                                                    <div class="form-error-message">
                                                        {% for error in form.gender.errors %}
                                                            {{ error }}
                                                        {% endfor %}
                                                    </div>
                                                   {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="single-input">
                                                    <label for="fName">Marrital Status</label>
                                                   {{form.marital_status}}
                                                   {% if form.marital_status.errors %}
                                                    <div class="form-error-message">
                                                        {% for error in form.marital_status.errors %}
                                                            {{ error }}
                                                        {% endfor %}
                                                    </div>
                                                   {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="single-input">
                                                    <label for="fName">Identity Type</label>
                                                   {{form.identity_type}}
                                                   {% if form.identity_type.errors %}
                                                    <div class="form-error-message">
                                                        {% for error in form.identity_type.errors %}
                                                            {{ error }}
                                                        {% endfor %}
                                                    </div>
                                                   {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-md-6 " style="padding-top: 10px;">
                                                <div class="single-input">
                                                    <label for="fName">Select Identity Image</label>

                                                    {{form.identity_image}}
                                                    {% if form.identity_image.errors %}
                                                    <div class="form-error-message">
                                                        {% for error in form.identity_image.errors %}
                                                            {{ error }}
                                                        {% endfor %}
                                                    </div>
                                                   {% endif %}
                                                    {% if kyc.identity_image %}
                                                        <img src="{{ kyc.identity_image.url }}" style="width: 100%; height: 200px; border-radius: 10px; object-fit: cover; padding-top: 10px;" alt="">
                                                    {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-md-6" style="padding-top: 10px;">
                                                <div class="single-input">
                                                    <label for="fName">Select Signature Image</label>

                                                    {{form.signature}}
                                                    {% if form.signature.errors %}
                                                    <div class="form-error-message">
                                                        {% for error in form.signature.errors %}
                                                            {{ error }}
                                                        {% endfor %}
                                                    </div>
                                                   {% endif %}
                                                    {% if kyc.signature %}
                                                        <img src="{{ kyc.signature.url }}" style="width: 100%; height: 200px; border-radius: 10px; object-fit: cover; padding-top: 10px;" alt="">
                                                    {% endif %}
                                                </div>
                                            </div>
                                            <br><br>
                                            <div class="col-md-12">
                                                <div class="btn-border">
                                                    <button class="cmn-btn" type="submit">Submit KYC</button>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Dashboard Section end -->

    <!-- Add Card Popup start -->
    <div class="add-card">
        <div class="container-fruid">
            <div class="row">
                <div class="col-lg-6">
                    <div class="modal fade" id="addcardMod" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header justify-content-between">
                                    <h6>Add Card</h6>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"><i class="fa-solid fa-xmark"></i></button>
                                </div>
                                <form action="#">
                                    <div class="row justify-content-center">
                                        <div class="col-md-12">
                                            <div class="single-input">
                                                <label for="cardNumber">Card Number</label>
                                                <input type="text" id="cardNumber" placeholder="5890 - 6858 - 6332 - 9843">
                                            </div>
                                        </div>
                                        <div class="col-md-12">
                                            <div class="single-input">
                                                <label for="cardHolder">Card Holder</label>
                                                <input type="text" id="cardHolder" placeholder="Alfred Davis">
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="single-input">
                                                <label for="month">Month</label>
                                                <input type="text" id="month" placeholder="12">
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="single-input">
                                                <label for="year">Year</label>
                                                <input type="text" id="year" placeholder="2025">
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="btn-border w-100">
                                                <button class="cmn-btn w-100">Add Card</button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Add Card Popup start -->

    <!-- My Card Popup start -->
    <div class="transactions-popup mycard">
        <div class="container-fruid">
            <div class="row">
                <div class="col-lg-6">
                    <div class="modal fade" id="transactionsMod" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header justify-content-between">
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"><i class="fa-solid fa-xmark"></i></button>
                                </div>
                                <div class="main-content">
                                    <div class="row">
                                        <div class="col-sm-4">
                                            <h5>My Cards</h5>
                                            <div class="icon-area">
                                                <img src="{% static 'assets1/images/popup-card.png' %}" alt="image" class="w-100">
                                            </div>
                                        </div>
                                        <div class="col-sm-8">
                                            <div class="right-area">
                                                <div class="top-area d-flex align-items-center justify-content-between">
                                                    <div class="card-details d-flex align-items-center">
                                                        <img src="{% static 'assets1/images/icon/mastercard.png' %}" alt="image">
                                                        <span>5880 **** **** 8854</span>
                                                    </div>
                                                    <a href="javascript:void(0)">
                                                        <i class="icon-h-edit"></i>
                                                        Edit
                                                    </a>
                                                </div>
                                                <ul class="payment-details">
                                                    <li>
                                                        <span>Card Type:</span>
                                                        <span>Visa</span>
                                                    </li>
                                                    <li>
                                                        <span>Card Holder:</span>
                                                        <span>Alfred Davis</span>
                                                    </li>
                                                    <li>
                                                        <span>Expires:</span>
                                                        <span>12/19</span>
                                                    </li>
                                                    <li>
                                                        <span>Card Number:</span>
                                                        <span>5880 5087 3288 8854</span>
                                                    </li>
                                                    <li>
                                                        <span>Total Balance:</span>
                                                        <span>80,700.00</span>
                                                    </li>
                                                    <li>
                                                        <span>Total Debt:</span>
                                                        <span>8,250.00</span>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- My Card Popup start -->
 
<script>
    var pinVisible = false;
    var actualPin = "{{account.pin_number}}";
    
    function togglePin() {
        var pinDisplay = document.getElementById('pin-display');
        var pinIcon = document.getElementById('pin-icon');
        
        if (pinVisible) {
            pinDisplay.textContent = '••••';
            pinIcon.classList.remove('fa-eye-slash');
            pinIcon.classList.add('fa-eye');
        } else {
            pinDisplay.textContent = actualPin;
            pinIcon.classList.remove('fa-eye');
            pinIcon.classList.add('fa-eye-slash');
        }
        pinVisible = !pinVisible;
    }
</script>

    {% endblock content %}
