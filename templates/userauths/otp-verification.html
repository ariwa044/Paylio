{% extends 'partials/base.html' %}
{% load static %}
{% block content %}
    <!-- OTP Verification start -->
    <section class="login-reg">
        <div class="overlay pt-120">
            <div class="container">
                <div class="row align-items-center justify-content-center">
                    <div class="col-xl-6 order-xl-0 order-1">
                        <div class="sec-img d-rtl">
                            <img src="{% static 'assets/images/login-reg-bg.png' %}" class="max-un" alt="image">
                        </div>
                    </div>
                    <div class="col-xl-5">
                    <div class="col-xl-5">
                        <div class="section-text text-center">
                            <h5 class="sub-title">Verification</h5>
                            <h2 class="title">Verify Your Account</h2>
                            <p class="mb-4">We sent a 6-digit code to your email. Please enter it below.</p>
                        </div>
                        
                        {% if messages %}
                            {% for message in messages %}
                                <div class="alert alert-{% if message.tags == 'error' %}danger{% else %}{{ message.tags }}{% endif %} text-center mb-4" role="alert">
                                    {{ message }}
                                </div>
                            {% endfor %}
                        {% endif %}
                            
                        <form method="POST">
                            {% csrf_token %}
                            <div class="row">
                                <div class="col-12">
                                    <div class="single-input mb-4">
                                        <input type="text" required name="otp" placeholder="000000" maxlength="6" style="text-align: center; letter-spacing: 8px; font-size: 32px; font-weight: bold; height: 60px;">
                                    </div>
                                    <button class="cmn-btn w-100 mb-4" type="submit">Verify Identity</button>
                                </div>
                            </div>
                        </form>
                        
                        <div class="text-center">
                            <p id="timer-text" class="mb-2">Resend code in <span id="time" class="text-primary font-weight-bold">60</span>s</p>
                            <a href="{% url 'userauths:resend-otp' %}" id="resend-btn" class="cmn-btn" style="background: transparent; color: #555; border: 1px solid #ddd; pointer-events: none; opacity: 0.5;">
                                Resend Email
                            </a>
                        </div>
                    </div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        var timeLeft = 60;
        var elem = document.getElementById('time');
        var timerId = setInterval(countdown, 1000);
        var resendBtn = document.getElementById('resend-btn');
        var timerText = document.getElementById('timer-text');

        function countdown() {
            if (timeLeft == -1) {
                clearTimeout(timerId);
                resendBtn.style.pointerEvents = 'auto';
                resendBtn.style.opacity = '1';
                resendBtn.style.color = 'var(--primary-color)';
                resendBtn.style.borderColor = 'var(--primary-color)';
                timerText.innerHTML = "Didn't receive the code?";
            } else {
                elem.innerHTML = timeLeft;
                timeLeft--;
            }
        }
    });
</script>
                </div>
            </div>
        </div>
    </section>
    <!-- OTP Verification end -->
{% endblock content %}
